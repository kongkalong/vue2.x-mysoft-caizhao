<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>TODO</title>
    <link rel="stylesheet" href="css/lesson1.css">
   	<script src="https://unpkg.com/vue/dist/vue.js"></script>
</head>

<body>
    <div id="todo">
        <h2>剩余待办：{{todoTotal}}条</h2>
        <div class="todo-input">
            <input type="text" v-model.trim="todoNew" class="todo.isnull">
            <button @click="todoAdd">添加</button>
        </div>
        <ul>
            <li v-for="(todo,index) in todoList">
                <input type="checkbox" id="'todo'+index" :key="index" v-model="todo.completed">
                <input type="text" v-if="todo.editable" v-model="todo.text">
                <label v-else for="'todo'+index" :class="{completed:todo.completed}">{{ todo.text }}</label>
                <button @click="editTodo(index)">{{ todo.editable | editShow}}</button>
                <button @click="todoRemove(index)" :disabled="todo.editable">删除</button>
            </li>
        </ul>

    </div>
    
    <script>
    	var todo = new Vue({
		    el: '#todo',
		    data: {
		        todoNew: '',
		        todoList: []
		    },
		    methods: {
		        todoAdd: function () {
		            //添加待办数据对象，包括text内容,completed完成状态,editable编辑状态三个属性
		            //添加后清空输入框
		            if(this.todoNew == ""){
		            	            	
		            }
		            else{
		            	this.todoList.push({text:this.todoNew,editable:false,completed:true	});
		            	this.todoNew = "";	
		            }
		            
		        },
		        todoRemove: function (index) {
		            //删除待办数据
		            this.todoList.splice(index,1);
		        },
		        editTodo: function (index) {
		            //编辑待办数据
		            this.todoList[index].editable = true;
		        }
		    },
		    filters: {
		        editShow: function (value) {
		        	//alert(value);
		            //按键文字切换，分别是「确认」和「编辑」，编辑中时「删除」按钮的状态为disable
		            if(value){
		            	return "确认";
		            }
		            else{
		            	return "编辑";
		            }
		            
		        }
		    },
		    computed: {
		        todoTotal: function () {
		            //todo:获取剩余待办数量
		            return this.todoList.length;
		        }
		    }
		})
    	
    </script>
</body>

</html>